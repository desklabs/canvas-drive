!function(n){"use strict";if(!(n.Desk&&n.Desk.canvas&&n.Desk.canvas.module)){var e={};if(n.Desk&&n.Desk.canvas)for(var t in n.Desk.canvas)n.Desk.canvas.hasOwnProperty(t)&&(e[t]=n.Desk.canvas[t]);var o=Object.prototype,r=Array.prototype,i=n.document,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a={hasOwn:function(n,e){return o.hasOwnProperty.call(n,e)},isUndefined:function(n){var e;return n===e},isNil:function(n){return a.isUndefined(n)||null===n||""===n},isNumber:function(n){return!!(0===n||n&&n.toExponential&&n.toFixed)},isFunction:function(n){return!!(n&&n.constructor&&n.call&&n.apply)},isArray:Array.isArray||function(n){return"[object Array]"===o.toString.call(n)},isArguments:function(n){return!(!n||!a.hasOwn(n,"callee"))},isObject:function(n){return null!==n&&"object"==typeof n},isString:function(n){return null!==n&&"string"==typeof n},appearsJson:function(n){return/^\{.*\}$/.test(n)},nop:function(){},invoker:function(n){a.isFunction(n)&&n()},identity:function(n){return n},each:function(n,e,t){if(!a.isNil(n)){var o,i,c=r.forEach,s=0;if(o=n.length,t=t||n,c&&c===n.forEach)n.forEach(e,t);else if(a.isNumber(o))for(;o>s;){if(e.call(t,n[s],s,n)===!1)return;s+=1}else for(i in n)if(a.hasOwn(n,i)&&e.call(t,n[i],i,n)===!1)return}},startsWithHttp:function(n,e){return a.isString(n)?"http"===n.substring(0,4)?n:e:n},map:function(n,e,t){var o=[],i=r.map;return a.isNil(n)?o:i&&n.map===i?n.map(e,t):(t=t||n,a.each(n,function(n,r,i){o.push(e.call(t,n,r,i))}),o)},values:function(n){return a.map(n,a.identity)},slice:function(n,e,t){return r.slice.call(n,a.isUndefined(e)?0:e,a.isUndefined(t)?n.length:t)},toArray:function(n){return n?n.toArray?n.toArray:a.isArray(n)?n:a.isArguments(n)?a.slice(n):a.values(n):[]},size:function(n){return a.toArray(n).length},indexOf:function(n,e){var t,o,i=r.indexOf;if(!n)return-1;if(i&&n.indexOf===i)return n.indexOf(e);for(t=0,o=n.length;o>t;t+=1)if(n[t]===e)return t;return-1},isEmpty:function(n){if(null===n)return!0;if(a.isArray(n)||a.isString(n))return 0===n.length;for(var e in n)if(a.hasOwn(n,e))return!1;return!0},remove:function(n,e){var t=a.indexOf(n,e);t>=0&&n.splice(t,1)},param:function(n,e){function t(n,r){a.isNil(r)||(r=a.isFunction(r)?r():r,a.isArray(r)?a.each(r,function(e){t(n,e)}):o[o.length]=e?encodeURIComponent(n)+"="+encodeURIComponent(r):n+"="+r)}var o=[];if(e=e||!1,a.isArray(n))a.each(n,function(n,e){t(e,n)});else for(var r in n)a.hasOwn(n,r)&&t(r,n[r]);return o.join("&").replace(/%20/g,"+")},objectify:function(n){var e,t,o,r,i,c,s={};if(a.isNil(n))return s;for("?"==n.substring(0,1)&&(n=n.substring(1)),e=n.split("&"),t=0;t<e.length;t+=1)o=e[t].split("="),r=o[0],i=o[1],c=s[r],a.isNil(c)?s[r]=i:a.isArray(c)?c[c.length]=i:(s[r]=[],s[r][0]=c,s[r][1]=i);return s},stripUrl:function(n){return a.isNil(n)?null:n.replace(/([^:]+:\/\/[^\/\?#]+).*/,"$1")},query:function(n,e){return a.isNil(e)?n:(n=n.replace(/#.*$/,""),n+=/^\#/.test(e)?e:(/\?/.test(n)?"&":"?")+e)},extend:function(n){return a.each(a.slice(arguments,1),function(e){a.each(e,function(e,t){n[t]=e})}),n},endsWith:function(n,e){return-1!==n.indexOf(e,n.length-e.length)},capitalize:function(n){return n.charAt(0).toUpperCase()+n.slice(1)},uncapitalize:function(n){return n.charAt(0).toLowerCase()+n.slice(1)},decode:function(n){var e,t,o,r,i,s=[],u="",l="",f=0;n=n.replace(/[^A-Za-z0-9\+\/\=]/g,"");do o=c.indexOf(n.charAt(f++)),r=c.indexOf(n.charAt(f++)),i=c.indexOf(n.charAt(f++)),l=c.indexOf(n.charAt(f++)),e=o<<2|r>>4,t=(15&r)<<4|i>>2,u=(3&i)<<6|l,s.push(String.fromCharCode(e)),64!==i&&s.push(String.fromCharCode(t)),64!==l&&s.push(String.fromCharCode(u)),e=t=u="",o=r=i=l="";while(f<n.length);return a.escapeToUTF8(s.join(""))},escapeToUTF8:function(n){for(var e="",t=0;t<n.length;){var o,r=n.charCodeAt(t++);if(128>r)e+=String.fromCharCode(r);else if(r>191&&224>r)o=n.charCodeAt(t++),e+=String.fromCharCode((31&r)<<6|63&o);else{o=n.charCodeAt(t++);var i=n.charCodeAt(t++);e+=String.fromCharCode((15&r)<<12|(63&o)<<6|63&i)}}return e},validEventName:function(n,e){var t,o=n.split(/\./),r=/^[$A-Z_][0-9A-Z_$]*$/i,i={Desk:!0,canvas:!0,force:!0,salesforce:!0,chatter:!0};return a.each(a.isArray(e)?e:[e],function(n){i[n]=!1}),o.length>2?1:2===o.length&&(t=o[0].toLowerCase(),i[t])?2:r.test(o[0])&&r.test(o[1])?0:3},prototypeOf:function(n){var e=Object.getPrototypeOf,t="__proto__";return a.isFunction(e)?e.call(Object,n):"object"==typeof{}[t]?n[t]:n.constructor.prototype},module:function(e,t){var o,r,i=e.split("."),c=n.Desk.canvas;for("canvas"===i[1]&&(i=i.slice(2)),r=i.length,o=0;r>o;o+=1)a.isUndefined(c[i[o]])&&(c[i[o]]={}),c=c[i[o]];return a.isFunction(t)&&(t=t()),a.extend(c,t)},document:function(){return i},byId:function(n){return i.getElementById(n)},byClass:function(n){return i.getElementsByClassName(n)},attr:function(n,e){var t,o=n.attributes;for(t=0;t<o.length;t+=1)if(e===o[t].name)return o[t].value},onReady:function(n){a.isFunction(n)&&s.push(n)},console:function(){function n(){try{return"sessionStorage"in window&&null!==window.sessionStorage}catch(n){return!1}}function e(){}function t(){}function o(){Function.prototype.bind?(e=Function.prototype.bind.call(console.log,console),t=Function.prototype.bind.call(console.error,console)):(e=function(){Function.prototype.apply.call(console.log,console,arguments)},t=function(){Function.prototype.apply.call(console.error,console,arguments)})}function r(){e=function(){},t=function(){}}function i(){a=!0,n()&&sessionStorage.setItem("canvas_console","true"),o()}function c(){a=!1,n()&&sessionStorage.setItem("canvas_console","false"),r()}var a=!1;return window&&!window.console&&(window.console={}),window&&!window.console.log&&(window.console.log=function(){}),window&&!window.console.error&&(window.console.error=function(){}),a=n()&&"true"===sessionStorage.getItem("canvas_console"),a?o():r(),{enable:i,disable:c,log:e,error:t}}()},s=[],u=function(n){a.isFunction(n)&&s.push(n)};!function(){function n(){r||(r=!0,n=a.nop,a.each(s,a.invoker),s=[])}function e(){if(!r)try{document.documentElement.doScroll("left"),n()}catch(t){setTimeout(e,30)}}var t,o,r=!1;if(document.addEventListener)document.addEventListener("DOMContentLoaded",n,!1);else if(document.attachEvent){try{t=self!==top}catch(i){}document.documentElement.doScroll&&!t&&e(),document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()})}window.addEventListener?window.addEventListener("load",n,!1):window.attachEvent?window.attachEvent("onload",n):(o=window.onload,window.onload=function(){o&&o(),n()})}(),a.each(a,function(n,e){u[e]=n}),a.each(e,function(n,e){u[e]=n}),function(){for(var n,e=function(){},t=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],o=t.length,r="undefined"!=typeof window&&window.console?window.console:{};o--;)n=t[o],r[n]||(r[n]=e)}(),n.Desk||(n.Desk={}),n.Desk.canvas=u}}(this);
!function(e,s){"use strict";var t=function(){function t(t,n,o){var a=Desk.JSON||JSON;if(e.isNil(n))throw"ERROR: target_url was not supplied on postMessage";var i=e.stripUrl(n);o=o||parent,s.postMessage&&(e.isObject(t)&&(t.targetModule="Canvas"),t=a.stringify(t),e.console.log("Sending Post Message ",t),o.postMessage(t,i))}function n(t,n){s.postMessage&&(t&&(a=function(s){var o,a,i=Desk.JSON||JSON;if(e.console.log("Post Message Got callback",s),!e.isNil(s)){if("string"==typeof n&&s.origin!==n)return e.console.log("source origin's don't match",s.origin,n),!1;if(e.isFunction(n)&&(a=n(s.origin,s.data),a===!1))return e.console.log("source origin's function returning false",s.origin,s.data),!1;if(e.appearsJson(s.data)){try{o=i.parse(s.data)}catch(r){}e.isNil(o)||!e.isNil(o.targetModule)&&"Canvas"!==o.targetModule||(e.console.log("Invoking callback"),t(o,a))}}}),s.addEventListener?s.addEventListener("message",a,!1):s.attachEvent("onmessage",a))}function o(){s.postMessage&&(s.removeEventListener?s.removeEventListener("message",a,!1):s.detachEvent("onmessage",a))}var a;return{post:t,receive:n,remove:o}}();e.module("Desk.canvas.xd",t)}(Desk.canvas,this);
!function(e){"use strict";var t,n="1.0.0",i=function(){function i(t){var n;return"*"===t?t:!e.isNil(t)&&(n=e.stripUrl(t),o=e.startsWithHttp(n,o))?o:(n=e.document().location.hash,n&&(n=decodeURIComponent(n.replace(/^#/,"")),o=e.startsWithHttp(n,o)),o)}function s(e){e&&r[e.type]&&r[e.type].callback(e)}var o,r=function(){function s(s,o){var r,u,l;if(c=c>100?0:c+1,a[c]=s,r={seq:c,src:"client",clientVersion:n,parentVersion:t,body:o},l=o&&o.config&&o.config.client,u=i(e.isNil(l)?null:l.targetOrigin),e.isNil(u))throw"ERROR: targetOrigin was not supplied and was not found on the hash tag, this can result from a redirect or link to another page.";e.console.log("posting message ",{message:r,to:u}),e.xd.post(r,u,parent)}function r(n,i){var s;if(n=n||e.oauth&&e.oauth.client(),(e.isNil(n)||e.isNil(n.oauthToken))&&(s={status:401,statusText:"Unauthorized",parentVersion:t,payload:"client or client.oauthToken not supplied"}),(e.isNil(n.instanceId)||e.isNil(n.targetOrigin))&&(s={status:400,statusText:"Bad Request",parentVersion:t,payload:"client.instanceId or client.targetOrigin not supplied"}),!e.isNil(s)){if(e.isFunction(i))return i(s),!1;throw s}return!0}var a=[],c=0,u=function(){return{callback:function(t){401===t.status&&e.isArray(t.payload)&&t.payload[0].errorCode&&"INVALID_SESSION_ID"===t.payload[0].errorCode&&e.oauth&&e.oauth.logout(),e.isFunction(a[t.seq])&&(e.isFunction(a[t.seq])||alert("not function"),a[t.seq](t))}}}(),l=function(){var i;return{ajax:function(t,n){var i,a,c;if(!t)throw"PRECONDITION ERROR: url required with AJAX call";if(!n||!e.isFunction(n.success))throw"PRECONDITION ERROR: function: 'settings.success' missing.";r(n.client,n.success)&&(i=n.success,c={method:"GET",async:!0,contentType:"application/json",headers:{Authorization:"OAuth "+n.client.oauthToken,Accept:"application/json"},data:null},a=e.extend(c,n||{}),a.success=void 0,a.failure=void 0,"*"===a.client.targetOrigin?a.client.targetOrigin=null:o=e.startsWithHttp(a.targetOrigin,o),s(i,{type:"ajax",url:t,config:a}))},ctx:function(e,t){r(t,e)&&s(e,{type:"ctx",accessToken:t.oauthToken,config:{client:t}})},token:function(t){return e.oauth&&e.oauth.token(t)},version:function(){return{clientVersion:n,parentVersion:t}},signedrequest:function(e){return arguments.length>0&&(i=e),i},refreshSignedRequest:function(e){var t=window.name.substring("canvas-frame-".length),n={oauthToken:"null",instanceId:t,targetOrigin:"*"};s(e,{type:"refresh",accessToken:n.oauthToken,config:{client:n}})},repost:function(e){var t=window.name.substring("canvas-frame-".length),n={oauthToken:"null",instanceId:t,targetOrigin:"*"},i=e||!1;s(null,{type:"repost",accessToken:n.oauthToken,config:{client:n},refresh:i})}}}(),h=function(){return{size:function(){var t=e.document().documentElement,n=t.scrollHeight,i=t.clientHeight,s=t&&t.scrollTop||e.document().body.scrollTop,o=t.scrollWidth,r=t.clientWidth,a=t&&t.scrollLeft||e.document().body.scrollLeft;return{heights:{contentHeight:n,pageHeight:i,scrollTop:s},widths:{contentWidth:o,pageWidth:r,scrollLeft:a}}}}}();return{services:l,frame:h,callback:u}}();return e.xd.receive(s,i),{ctx:r.services.ctx,ajax:r.services.ajax,token:r.services.token,version:r.services.version,size:r.frame.size,signedrequest:r.services.signedrequest,refreshSignedRequest:r.services.refreshSignedRequest,repost:r.services.repost}}();e.module("Desk.canvas.client",i)}(Desk.canvas);